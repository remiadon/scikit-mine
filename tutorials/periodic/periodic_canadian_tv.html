

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Periodic pattern mining on canadian TV logs &mdash; scikit-mine 0.0.6 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/skmine_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation from pypi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html#installation-from-sources">Installation from sources</a></li>
</ul>
<p><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference/datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/feature_extraction.html">Feature Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/preprocessing.html">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/itemsets.html">Itemsets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/periodic.html">Periodic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/emerging.html">Emerging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/base.html">Base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/callbacks.html">Callback API</a></li>
</ul>
<p><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../datasets/fetch_fimi_datasets.html">fetch FIMI datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datasets/synthetic_transactions.html">Generate synthetic data to train on</a></li>
<li class="toctree-l1"><a class="reference internal" href="../itemsets/LCM_on_chess.html">Linear time Closed item set Miner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../itemsets/SLIM.html">SLIM for market basket analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../itemsets/symbolic_classifier.html">Building a symbolic classifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="../callbacks/callbacks.html">Callback API demo</a></li>
</ul>
<p><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../sklearn_compat.html">Compatibility with Scikit-Learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html#inclusion-criteria">Inclusion criteria</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html#development-process">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HISTORY.html">History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">scikit-mine</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Periodic pattern mining on canadian TV logs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/periodic/periodic_canadian_tv.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Periodic-pattern-mining-on-canadian-TV-logs">
<h1>Periodic pattern mining on canadian TV logs<a class="headerlink" href="#Periodic-pattern-mining-on-canadian-TV-logs" title="Permalink to this headline">¶</a></h1>
<p><img alt="logo" src="../../_images/skmine_series.png" /></p>
<section id="The-problem,-informally">
<h2>The problem, informally<a class="headerlink" href="#The-problem,-informally" title="Permalink to this headline">¶</a></h2>
<p>Let’s take a simple example.</p>
<p>Imagine you set an alarm to wake up every day around 7:30AM, and go to work. Sometimes you wake up a bit earlier (your body anticipates on the alarm), and sometimes a bit later, for example if you press the “snooze” button and refuse to face the fact that you have to wake up.</p>
<p>In python we can load those “wake up” events as logs, and store them in a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html">pandas.Series</a>, like</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">one_day</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span>  <span class="c1"># a day in minutes</span>
<span class="n">minutes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">one_day</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">one_day</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">one_day</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">one_day</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">one_day</span> <span class="o">*</span> <span class="mi">7</span><span class="p">]</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="s2">&quot;wake up&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">minutes</span><span class="p">)</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s2">&quot;16/04/2020 07:30&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y %H:%M&quot;</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">start</span> <span class="o">+</span> <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="n">e</span><span class="p">))</span>
<span class="n">S</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>  <span class="c1"># minutes as the lowest unit of difference</span>
<span class="n">S</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2020-04-16 07:30:00    wake up
2020-04-17 07:29:00    wake up
2020-04-18 07:30:00    wake up
2020-04-19 07:31:00    wake up
2020-04-20 07:30:00    wake up
2020-04-23 07:30:00    wake up
dtype: object
</pre></div></div>
</div>
<p>We can see the wake-up time is not exactly the same every day, but overall a consistent regular pattern seems to emerge.</p>
<p>Now imagine that in addition to wake up times, we also have records of other daily activities (meals, work, household chores, etc.), and that rather than a handful of days, those records span several years and make up several thousands of events</p>
<p><strong>How would you be able to detect regularities in the data ?</strong></p>
</section>
<section id="Introduction-to-periodic-pattern-mining">
<h2>Introduction to periodic pattern mining<a class="headerlink" href="#Introduction-to-periodic-pattern-mining" title="Permalink to this headline">¶</a></h2>
<p>Periodic pattern mining aims at exploiting regularities not only about <code class="docutils literal notranslate"><span class="pre">what</span> <span class="pre">happens</span></code> by finding coordinated event occurrences, but also about <code class="docutils literal notranslate"><span class="pre">when</span> <span class="pre">it</span> <span class="pre">happens</span></code> and <code class="docutils literal notranslate"><span class="pre">how</span> <span class="pre">it</span> <span class="pre">happens</span></code>, by <strong>finding consistent inter-occurrence timeintervals</strong>.</p>
<p>Next, we introduce the concept of cycles</p>
<section id="The-cycle-:-a-building-block-for-periodic-pattern-mining">
<h3>The cycle : a building block for periodic pattern mining<a class="headerlink" href="#The-cycle-:-a-building-block-for-periodic-pattern-mining" title="Permalink to this headline">¶</a></h3>
<p>Here is an explicit example of a cycle</p>
<p><img alt="cycle" src="../../_images/cycle_color.png" /></p>
<p>This definition, while being relatively simple, is general enough to allow us to find regularities in different types of logs</p>
</section>
<section id="Handling-noise-in-our-timestamps">
<h3>Handling noise in our timestamps<a class="headerlink" href="#Handling-noise-in-our-timestamps" title="Permalink to this headline">¶</a></h3>
<p>Needless to say, it would be too easy if events in our data were equally spaced. As data often comes noisy, we have to be fault tolerant, and allow small errors to sneak into our cycles.</p>
<p>That’s the role of <code class="docutils literal notranslate"><span class="pre">shift</span> <span class="pre">corrections</span></code>, which capture the small deviations from perfectly regular periodic repetitions, and allow to reconstruct the (noisy) original sequence of events, using the following relation <img alt="shifts" src="../../_images/shifts.png" /></p>
</section>
<section id="A-tiny-example-with-scikit-mine">
<h3>A tiny example with scikit-mine<a class="headerlink" href="#A-tiny-example-with-scikit-mine" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">scikit-mine</span></code> offers a <code class="docutils literal notranslate"><span class="pre">PeriodicCycleMiner</span></code>, out of the box. You can use it to <strong>detect regularities, in the form of cycles</strong>, in the input data.</p>
<p>These regularities are submitted to an MDL criterion, so that we do not mistakenly include redundant occurences, nor forget to consider other intervals that would sumarize our data in a better way.</p>
<p>MDL offers a framework to find <code class="docutils literal notranslate"><span class="pre">the</span> <span class="pre">best</span> <span class="pre">set</span> <span class="pre">of</span> <span class="pre">cycles</span></code>, i.e the set that gives the most succint representation of the data. And <code class="docutils literal notranslate"><span class="pre">as</span> <span class="pre">humans,</span> <span class="pre">we</span> <span class="pre">often</span> <span class="pre">like</span> <span class="pre">to</span> <span class="pre">deal</span> <span class="pre">with</span> <span class="pre">non-redundant,</span> <span class="pre">well</span> <span class="pre">organized</span> <span class="pre">data</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">skmine.periodic</span> <span class="kn">import</span> <span class="n">PeriodicCycleMiner</span>
<span class="n">pcm</span> <span class="o">=</span> <span class="n">PeriodicCycleMiner</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">pcm</span><span class="o">.</span><span class="n">discover</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>start</th>
      <th>length</th>
      <th>period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>wake up</th>
      <th>0</th>
      <td>2020-04-16 07:30:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>You can see one cycle has been extracted for our event <code class="docutils literal notranslate"><span class="pre">wake</span> <span class="pre">up</span></code>. The cycle covers the entire business week, but not the last monday separated by the weekend</p>
<p>It has a length of 5 and a period close to 1 day, as expected.</p>
<p>Also, note that we “lost” some information here. Our period of 1 day offers the best summary for this data. Accessing the little “shifts” as encountered in original data is also possible, with an extra argument in our <code class="docutils literal notranslate"><span class="pre">.discover</span></code> call</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pcm</span><span class="o">.</span><span class="n">discover</span><span class="p">(</span><span class="n">shifts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>start</th>
      <th>length</th>
      <th>period</th>
      <th>dE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>wake up</th>
      <th>0</th>
      <td>2020-04-16 07:30:00</td>
      <td>5</td>
      <td>1 days</td>
      <td>[-6, 6, 6, -6]</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The last column named <code class="docutils literal notranslate"><span class="pre">dE</span></code> contains a list of shifts to apply to our cycle in case we want to reconstruct the original data. Trailing zeros have been removed for efficiency, but we can see there is: * a -60 second shift between the first and second entry (one minute early on tuesday) * a 60 second shift between the second and third entry (back to 7:30 on wednesday) * an 60 second shift between the third and fourth entry (one minute late on thursday) * an -60 second shift between the fourth
and fifth entry (back to 7:30 on friday)</p>
<p>Also note that we can get the “uncovered” events, called <code class="docutils literal notranslate"><span class="pre">redisuals</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pcm</span><span class="o">.</span><span class="n">get_residuals</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2020-04-23 07:30:00    wake up
dtype: object
</pre></div></div>
</div>
<p>This way <code class="docutils literal notranslate"><span class="pre">pcm</span></code> does not store all the data, but has all information needed to reconstruct it entirely !!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pcm</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2020-04-16 07:30:00    wake up
2020-04-17 07:29:00    wake up
2020-04-18 07:30:00    wake up
2020-04-19 07:31:00    wake up
2020-04-20 07:30:00    wake up
2020-04-23 07:30:00    wake up
dtype: object
</pre></div></div>
</div>
</section>
</section>
<section id="An-example-with-Canadian-TV-programs">
<h2>An example with Canadian TV programs<a class="headerlink" href="#An-example-with-Canadian-TV-programs" title="Permalink to this headline">¶</a></h2>
<section id="Fetching-logs-from-canadian-TV">
<h3>Fetching logs from canadian TV<a class="headerlink" href="#Fetching-logs-from-canadian-TV" title="Permalink to this headline">¶</a></h3>
<p>In this section we are going to load some event logs of TV programs (the <code class="docutils literal notranslate"><span class="pre">WHAT</span></code>), indexed by their broadcast timestamps (the <code class="docutils literal notranslate"><span class="pre">WHEN</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">PeriodicCycleMiner</span></code> is here to help us discovering regularities (the <code class="docutils literal notranslate"><span class="pre">HOW</span></code>)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">skmine.datasets</span> <span class="kn">import</span> <span class="n">fetch_canadian_tv</span>
<span class="kn">from</span> <span class="nn">skmine.periodic</span> <span class="kn">import</span> <span class="n">PeriodicCycleMiner</span>
</pre></div>
</div>
</div>
</section>
<section id="Searching-for-cycles-in-TV-programs">
<h3>Searching for cycles in TV programs<a class="headerlink" href="#Searching-for-cycles-in-TV-programs" title="Permalink to this headline">¶</a></h3>
<p>Remember about the definition of cycles ? Let’s apply it to our TV programs</p>
<p>In our case</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> is the name of a TV program</p></li>
<li><p><span class="math notranslate nohighlight">\(r\)</span> is the number of broadcasts (repetitions) for this TV program (inside this cycle)</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> is the optimal time delta between broadcasts in this cycle. If a program is meant to be live everyday at 14:00PM, then <span class="math notranslate nohighlight">\(p\)</span> is likely to be <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">day</span></code></p></li>
<li><p><span class="math notranslate nohighlight">\(\tau\)</span> is the first broadcast time in this cycle</p></li>
<li><p><span class="math notranslate nohighlight">\(dE\)</span> are the shift corrections between the <span class="math notranslate nohighlight">\(p\)</span> and the actual broadcast time of an event. If a TV program was scheduled at 8:30:00AM and it went on air at 8:30:23AM the same day, then we keep track of a <code class="docutils literal notranslate"><span class="pre">23</span> <span class="pre">seconds</span> <span class="pre">shift</span></code>. This way we can summarize our data (via cycles), and reconstruct it (via shift corrections).</p></li>
</ul>
<p>Finally we are going to dig a little deeper into these cycles, to answer quite complex questions about our logs. We will see that cycles contains usefull information about our input data</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ctv_logs</span> <span class="o">=</span> <span class="n">fetch_canadian_tv</span><span class="p">()</span>
<span class="n">ctv_logs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
timestamp
2020-08-01 06:00:00            The Moblees
2020-08-01 06:11:00    Big Block Sing Song
2020-08-01 06:13:00    Big Block Sing Song
2020-08-01 06:15:00               CBC Kids
2020-08-01 06:15:00               CBC Kids
Name: canadian_tv, dtype: string
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pcm</span> <span class="o">=</span> <span class="n">PeriodicCycleMiner</span><span class="p">()</span>
<span class="n">pcm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ctv_logs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/radon/miniconda3/envs/skmine/lib/python3.6/site-packages/scikit_mine-0.0.5-py3.6.egg/skmine/periodic/cycles.py:414: UserWarning: found duplicates in input sequence, removing them
  warnings.warn(&#34;found duplicates in input sequence, removing them&#34;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;skmine.periodic.cycles.PeriodicCycleMiner at 0x7fed4883f048&gt;
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Note</span></code> : no need to worry for the warning, it’s here to notify duplicate event/timestamp pairs have been found</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cycles</span> <span class="o">=</span> <span class="n">pcm</span><span class="o">.</span><span class="n">discover</span><span class="p">()</span>
<span class="n">cycles</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>start</th>
      <th>length</th>
      <th>period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">Addison</th>
      <th>0</th>
      <td>2020-08-03 07:11:00</td>
      <td>5</td>
      <td>1 days 00:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-10 07:11:00</td>
      <td>5</td>
      <td>1 days 00:00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-17 07:11:00</td>
      <td>5</td>
      <td>1 days 00:00:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-24 07:11:00</td>
      <td>5</td>
      <td>1 days 00:00:00</td>
    </tr>
    <tr>
      <th>Arthur Shorts</th>
      <th>0</th>
      <td>2020-08-17 09:48:00</td>
      <td>5</td>
      <td>1 days 00:00:00</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">This Hour Has 22 Minutes</th>
      <th>2</th>
      <td>2020-08-11 00:30:00</td>
      <td>7</td>
      <td>0 days 00:30:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-25 02:00:00</td>
      <td>4</td>
      <td>0 days 00:30:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-08-12 19:00:00</td>
      <td>4</td>
      <td>1 days 00:00:00</td>
    </tr>
    <tr>
      <th>Thrillusionists</th>
      <th>0</th>
      <td>2020-08-02 07:36:00</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
    </tr>
    <tr>
      <th>Vet on the Hill</th>
      <th>0</th>
      <td>2020-08-03 16:00:00</td>
      <td>5</td>
      <td>1 days 00:00:00</td>
    </tr>
  </tbody>
</table>
<p>86 rows × 3 columns</p>
</div></div>
</div>
<p>The resulting dataframe has a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.MultiIndex.html">MultIndex</a>.</p>
<p>The first level is the event name, the second level corresponds to the cycle number, as we can detect multiple cycles for the same event</p>
<p>Now that we have our cycles in a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">pandas.DataFrame</a>, we can play with the pandas API and answer questions about our logs</p>
</section>
<section id="Did-I-find-cycles-for-the-TV-show-“Arthurt-Shorts”">
<h3>Did I find cycles for the TV show “Arthurt Shorts”<a class="headerlink" href="#Did-I-find-cycles-for-the-TV-show-“Arthurt-Shorts”" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cycles</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Arthur Shorts&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>start</th>
      <th>length</th>
      <th>period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-08-17 09:48:00</td>
      <td>5</td>
      <td>1 days 00:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-24 09:48:00</td>
      <td>5</td>
      <td>0 days 23:59:30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-04 09:48:00</td>
      <td>4</td>
      <td>1 days 00:00:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-12 09:47:00</td>
      <td>3</td>
      <td>1 days 00:00:30</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="What-are-the-top-10-longest-cycles-?">
<h3>What are the top 10 longest cycles ?<a class="headerlink" href="#What-are-the-top-10-longest-cycles-?" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cycles</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>start</th>
      <th>length</th>
      <th>period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Grand Designs</th>
      <th>0</th>
      <td>2020-08-01 05:00:00</td>
      <td>31</td>
      <td>1 days 00:00:00</td>
    </tr>
    <tr>
      <th>Schitt's Creek</th>
      <th>0</th>
      <td>2020-08-28 00:00:00</td>
      <td>8</td>
      <td>0 days 00:30:00</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Kim's Convenience</th>
      <th>0</th>
      <td>2020-08-05 00:30:00</td>
      <td>7</td>
      <td>0 days 00:30:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-26 00:30:00</td>
      <td>7</td>
      <td>0 days 00:30:00</td>
    </tr>
    <tr>
      <th>Mr. D</th>
      <th>0</th>
      <td>2020-08-06 00:30:00</td>
      <td>7</td>
      <td>0 days 00:30:00</td>
    </tr>
    <tr>
      <th>Schitt's Creek</th>
      <th>1</th>
      <td>2020-08-07 00:30:00</td>
      <td>7</td>
      <td>0 days 00:30:00</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">This Hour Has 22 Minutes</th>
      <th>0</th>
      <td>2020-08-18 00:30:00</td>
      <td>7</td>
      <td>0 days 00:30:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-04 00:30:00</td>
      <td>7</td>
      <td>0 days 00:30:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-11 00:30:00</td>
      <td>7</td>
      <td>0 days 00:30:00</td>
    </tr>
    <tr>
      <th>Addison</th>
      <th>0</th>
      <td>2020-08-03 07:11:00</td>
      <td>5</td>
      <td>1 days 00:00:00</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="what-are-the-10-most-unpunctual-TV-programs-?">
<h3>what are the 10 most unpunctual TV programs ?<a class="headerlink" href="#what-are-the-10-most-unpunctual-TV-programs-?" title="Permalink to this headline">¶</a></h3>
<p>For this we are going to : 1. extract the shift corrections along with other informations about our cycles 2. compute the sum of the absolute values for the shift corrections, for every cycles 3. get the 10 biggest sums</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">full_cycles</span> <span class="o">=</span> <span class="n">pcm</span><span class="o">.</span><span class="n">discover</span><span class="p">(</span><span class="n">shifts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">full_cycles</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>start</th>
      <th>length</th>
      <th>period</th>
      <th>dE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">Addison</th>
      <th>0</th>
      <td>2020-08-03 07:11:00</td>
      <td>5</td>
      <td>1 days</td>
      <td>[0, 0, 0, 0]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-10 07:11:00</td>
      <td>5</td>
      <td>1 days</td>
      <td>[0, 0, 0, 0]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-17 07:11:00</td>
      <td>5</td>
      <td>1 days</td>
      <td>[0, 0, 0, 0]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-24 07:11:00</td>
      <td>5</td>
      <td>1 days</td>
      <td>[0, 0, 0, 0]</td>
    </tr>
    <tr>
      <th>Arthur Shorts</th>
      <th>0</th>
      <td>2020-08-17 09:48:00</td>
      <td>5</td>
      <td>1 days</td>
      <td>[0, 0, 0, 0]</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">absolute_sum</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">abs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">))</span>

<span class="c1"># level 0 is the name of the TV program</span>
<span class="n">shift_sums</span> <span class="o">=</span> <span class="n">full_cycles</span><span class="p">[</span><span class="s2">&quot;dE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">absolute_sum</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">shift_sums</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Rusty Rivets                             120
Arthur Shorts                             48
Kiri &amp; Lou                                24
Daniel Tiger&#39;s Neighbourhood              18
PJ Masks                                  18
Daisy &amp; The Gumboot Kids                  12
Holy Baloney                              12
Thrillusionists                           12
Ollie: The Boy Who Became What He Ate      6
The Strange Chores                         6
Name: dE, dtype: int64
</pre></div></div>
</div>
</section>
<section id="What-TV-programs-have-been-broadcasted-every-day-for-at-least-5-days-straight?">
<h3>What TV programs have been broadcasted every day for at least 5 days straight?<a class="headerlink" href="#What-TV-programs-have-been-broadcasted-every-day-for-at-least-5-days-straight?" title="Permalink to this headline">¶</a></h3>
<p>Let’s make use of the <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html">pandas.DataFrame.query</a> method to express our question in an SQL-like syntax</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cycles</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;length &gt;= 5 and period &gt;= &quot;1 days&quot;&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>start</th>
      <th>length</th>
      <th>period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">Addison</th>
      <th>0</th>
      <td>2020-08-03 07:11:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-10 07:11:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-17 07:11:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-24 07:11:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Arthur Shorts</th>
      <th>0</th>
      <td>2020-08-17 09:48:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Beat Bugs</th>
      <th>0</th>
      <td>2020-08-03 07:30:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-10 07:30:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-17 07:30:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-24 07:30:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Big Block Sing Song</th>
      <th>0</th>
      <td>2020-08-03 07:25:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">CBC News Network</th>
      <th>0</th>
      <td>2020-08-10 12:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-17 12:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-24 12:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Coronation Street Omnibus</th>
      <th>0</th>
      <td>2020-08-02 08:57:00</td>
      <td>5</td>
      <td>7 days</td>
    </tr>
    <tr>
      <th>Daisy &amp; The Gumboot Kids</th>
      <th>0</th>
      <td>2020-08-01 07:40:00</td>
      <td>5</td>
      <td>7 days</td>
    </tr>
    <tr>
      <th>Does It Fart?</th>
      <th>0</th>
      <td>2020-08-02 07:30:00</td>
      <td>5</td>
      <td>7 days</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Dragons' Den</th>
      <th>0</th>
      <td>2020-08-03 11:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-10 11:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-17 11:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-24 11:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Escape to the Country</th>
      <th>0</th>
      <td>2020-08-03 15:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Grand Designs</th>
      <th>0</th>
      <td>2020-08-01 05:00:00</td>
      <td>31</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Heartland</th>
      <th>0</th>
      <td>2020-08-03 14:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Holy Baloney</th>
      <th>0</th>
      <td>2020-08-02 07:34:00</td>
      <td>5</td>
      <td>7 days</td>
    </tr>
    <tr>
      <th>Just For Laughs: Gags</th>
      <th>0</th>
      <td>2020-08-03 19:30:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Murdoch Mysteries</th>
      <th>0</th>
      <td>2020-08-03 13:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Ollie: The Boy Who Became What He Ate</th>
      <th>0</th>
      <td>2020-08-10 08:59:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Rusty Rivets</th>
      <th>0</th>
      <td>2020-08-17 08:44:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>The Strange Chores</th>
      <th>0</th>
      <td>2020-08-01 11:48:00</td>
      <td>5</td>
      <td>7 days</td>
    </tr>
    <tr>
      <th>The Sunday Scrum</th>
      <th>0</th>
      <td>2020-08-02 11:00:00</td>
      <td>5</td>
      <td>7 days</td>
    </tr>
    <tr>
      <th>Thrillusionists</th>
      <th>0</th>
      <td>2020-08-02 07:36:00</td>
      <td>5</td>
      <td>7 days</td>
    </tr>
    <tr>
      <th>Vet on the Hill</th>
      <th>0</th>
      <td>2020-08-03 16:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="What-TV-programs-are-broadcast-only-on-business-days-?">
<h2>What TV programs are broadcast only on business days ?<a class="headerlink" href="#What-TV-programs-are-broadcast-only-on-business-days-?" title="Permalink to this headline">¶</a></h2>
<p>From the previous query we see we have a lot of 5-length cycles, with periods of 1 day. An intuition is that these cycles take place on business days. Let’s confirm this by considering cycles with 1. start timestamps on mondays 2. periods of roughly 1 day</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">monday_starts</span> <span class="o">=</span> <span class="n">cycles</span><span class="p">[</span><span class="n">cycles</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekday</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># start on monday</span>
<span class="n">monday_starts</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;length == 5 and period &gt;= &quot;1 days&quot;&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>start</th>
      <th>length</th>
      <th>period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">Addison</th>
      <th>0</th>
      <td>2020-08-03 07:11:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-10 07:11:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-17 07:11:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-24 07:11:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Arthur Shorts</th>
      <th>0</th>
      <td>2020-08-17 09:48:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Beat Bugs</th>
      <th>0</th>
      <td>2020-08-03 07:30:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-10 07:30:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-17 07:30:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-24 07:30:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Big Block Sing Song</th>
      <th>0</th>
      <td>2020-08-03 07:25:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">CBC News Network</th>
      <th>0</th>
      <td>2020-08-10 12:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-17 12:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-24 12:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Dragons' Den</th>
      <th>0</th>
      <td>2020-08-03 11:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-10 11:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-17 11:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-24 11:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Escape to the Country</th>
      <th>0</th>
      <td>2020-08-03 15:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Heartland</th>
      <th>0</th>
      <td>2020-08-03 14:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Just For Laughs: Gags</th>
      <th>0</th>
      <td>2020-08-03 19:30:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Murdoch Mysteries</th>
      <th>0</th>
      <td>2020-08-03 13:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Ollie: The Boy Who Became What He Ate</th>
      <th>0</th>
      <td>2020-08-10 08:59:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Rusty Rivets</th>
      <th>0</th>
      <td>2020-08-17 08:44:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>Vet on the Hill</th>
      <th>0</th>
      <td>2020-08-03 16:00:00</td>
      <td>5</td>
      <td>1 days</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="References">
<h1>References<a class="headerlink" href="#References" title="Permalink to this headline">¶</a></h1>
<ol class="arabic simple">
<li><p>Galbrun, E &amp; Cellier, P &amp; Tatti, N &amp; Termier, A &amp; Crémilleux, B “Mining Periodic Pattern with a MDL Criterion”</p></li>
<li><p>Galbrun, E “The Minimum Description Length Principle for Pattern Mining : A survey”</p></li>
<li><p>Termier, A <a class="reference external" href="http://people.irisa.fr/Alexandre.Termier/dmv/DMV_Periodic_patterns.pdf">“Periodic pattern mining”</a></p></li>
</ol>
</section>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Rémi Adon

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>